<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Table</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        /* Custom styling for the table */
        .custom-table-container {
            margin: 20px auto;
            width: 80%;
        }
        .custom-table {
            font-size: 16px;
            text-align: center;
        }
        th {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container custom-table-container">
        <h1 class="text-center">Dynamic Table</h1>

        <!-- Filter Form -->
        <form method="POST" class="mb-3">
            <div class="row g-3">
                <div class="col-md-4">
                    <input type="text" name="date" class="form-control" placeholder="Date" />
                </div>
                <div class="col-md-4">
                    <input type="text" name="time" class="form-control" placeholder="Time" />
                </div>
                <div class="col-md-4">
                    <input type="text" name="classroom" class="form-control" placeholder="Classroom" />
                </div>
                <div class="col-md-4">
                    <button type="submit" class="btn btn-primary">Filter</button>
                </div>
            </div>
        </form>

        <!-- Dynamic Table -->
        <div class="table-responsive">
            <table id="dynamic-table" class="table table-striped custom-table">
                <thead>
                    <tr>
                        {% for column in columns %}
                            <th onclick="sortTable({{ loop.index0 }})">{{ column }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in table %}
                        <tr>
                            {% for column in columns %}
                                <td>{{ row[column] }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        function sortTable(columnIndex) {
            const table = document.getElementById("dynamic-table");
            const rows = Array.from(table.rows).slice(1); // Exclude header row
            const isAscending = table.dataset.sortOrder !== "asc";

            // Sort rows
            rows.sort((a, b) => {
                const cellA = a.cells[columnIndex].innerText.trim();
                const cellB = b.cells[columnIndex].innerText.trim();

                if (!isNaN(Date.parse(cellA)) && !isNaN(Date.parse(cellB))) {
                    // Sort as dates if applicable
                    return isAscending
                        ? new Date(cellA) - new Date(cellB)
                        : new Date(cellB) - new Date(cellA);
                } else if (!isNaN(cellA) && !isNaN(cellB)) {
                    // Sort as numbers if applicable
                    return isAscending
                        ? parseFloat(cellA) - parseFloat(cellB)
                        : parseFloat(cellB) - parseFloat(cellA);
                } else {
                    // Sort as strings
                    return isAscending
                        ? cellA.localeCompare(cellB)
                        : cellB.localeCompare(cellA);
                }
            });

            // Rebuild the table body
            const tbody = table.tBodies[0];
            rows.forEach(row => tbody.appendChild(row));

            // Update sort order
            table.dataset.sortOrder = isAscending ? "asc" : "desc";
        }
    </script>
</body>
</html>
